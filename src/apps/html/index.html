<!--
******************************************************************************
#
# Copyright (C) 2023 - 2028 KETI, All rights reserved.
#                           (Korea Electronics Technology Institute)
#
# Permission is hereby granted, free of charge, to any person obtaining a copy
# of this software and associated documentation files (the "Software"), to deal
# in the Software without restriction, including without limitation the rights
# to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
# copies of the Software, and to permit persons to whom the Software is
# furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in
# all copies or substantial portions of the Software.
#
# Use of the Software is limited solely to applications:
# (a) running for Korean Government Project, or
# (b) that interact with KETI project/platform.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
# IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
# FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL
# KETI BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
# WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF
# OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
# SOFTWARE.
#
# Except as contained in this notice, the name of the KETI shall not be used
# in advertising or otherwise to promote the sale, use or other dealings in
# this Software without prior written authorization from KETI.
#
******************************************************************************
-->

<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Guides</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
<link href="https://api.mapbox.com/mapbox-gl-js/v3.5.1/mapbox-gl.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Bungee+Inline&display=swap" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v3.5.1/mapbox-gl.js"></script>

<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>

<link rel="stylesheet" href="styles.css">

</head>
<body>
<div id="map"></div>
<div id="bottom-info-background"></div>





<!-- 
<div id="csv-status">
    <span id="csv-data-count">수집된 데이터: 0개</span>
    <button id="downloadCSVButton" onclick="downloadCSV()">CSV 다운로드</button>
    <button id="clearCSVButton" onclick="clearCSVData()">데이터 초기화</button>
    <button id="autoSaveButton" onclick="toggleAutoSave()">자동저장 시작</button>
</div>
-->



<!-- 그래프 버튼들 -->
<div id="graph-buttons" style="display: none;">
    <!-- PRR 버튼 -->
    <div id="prr-button" class="graph-button-expandable">
        <button class="graph-button-header">
            <div class="graph-button-single-line">
                PRR 현재:<span id="prr-current">--%</span> 평균:<span id="prr-average">--%</span>
            </div>
        </button>
        
        <!-- PRR 그래프 -->
        <div id="graph1" class="liquid-graph-container" style="display: none;">
            <div class="graph-content">
                <div id="prr-chart-area" class="chart-area"></div>
            </div>
            <div class="graph-controls">
                <div class="control-row">
                    <label class="control-label">패킷 크기:</label>
                    <input type="number" id="prr-range-size-input" class="size-input" value="500" min="0" max="1000" step="10">
                    <span class="control-unit">패킷</span>
                </div>
                <div class="slider-container">
                    <div id="prr-range-track" class="range-track">
                        <div id="prr-selected-range" class="selected-range"></div>
                    </div>
                </div>
                <div id="prr-range-text" class="range-info">범위: 0 ~ 500 패킷 (크기: 500)</div>
            </div>
        </div>
    </div>
    
    <!-- Latency 버튼 -->
    <div id="latency-button" class="graph-button-expandable">
        <button class="graph-button-header">
            <div class="graph-button-single-line">
                Latency 현재:<span id="latency-current">--ms</span> 평균:<span id="latency-average">--ms</span>
            </div>
        </button>
        
        <!-- Latency 그래프 -->
        <div id="graph2" class="liquid-graph-container" style="display: none;">
            <div class="graph-content">
                <div id="latency-chart-area" class="chart-area"></div>
            </div>
        </div>
    </div>
    
    <!-- RSSI 버튼 -->
    <div id="rssi-button" class="graph-button-expandable">
        <button class="graph-button-header">
            <div class="graph-button-single-line">
                RSSI 현재:<span id="rssi-current">--dBm</span> 평균:<span id="rssi-average">--dBm</span>
            </div>
        </button>
        
        <!-- RSSI 그래프 -->
        <div id="graph3" class="liquid-graph-container" style="display: none;">
            <div class="graph-content">
                <div id="rssi-chart-area" class="chart-area"></div>
            </div>
        </div>
    </div>
    
    <!-- RCPI 버튼 -->
    <div id="rcpi-button" class="graph-button-expandable">
        <button class="graph-button-header">
            <div class="graph-button-single-line">
                RCPI 현재:<span id="rcpi-current">--dBm</span> 평균:<span id="rcpi-average">--dBm</span>
            </div>
        </button>
        
        <!-- RCPI 그래프 -->
        <div id="graph4" class="liquid-graph-container" style="display: none;">
            <div class="graph-content">
                <div id="rcpi-chart-area" class="chart-area"></div>
            </div>
        </div>
    </div>
</div>

<!-- 기존 그래프 컨테이너 제거 -->

<!-- 장치별 센서값 표시 (초기에는 숨김) -->
<!-- OBU TX 장치 센서값 -->
<div id="obu-tx-sensor" class="sensor-panel" style="display: none;">
    <div class="sensor-header">
        <h3>🚗 <span id="obu-tx-device-name">OBU TX Device</span></h3>
        <div class="device-status">
            <span id="obu-tx-status">연결됨</span>
            <span id="obu-tx-last-seen">방금 전</span>
        </div>
    </div>
    
    <!-- 장치별 제어 버튼 -->
    <div class="sensor-controls">
        <button id="obu-tx-auto-track" class="sensor-control-button">AUTO TRACK</button>
        <button id="obu-tx-visible-path" class="sensor-control-button">VISIBLE PATH</button>
        <button id="obu-tx-communication-line" class="sensor-control-button" data-button-type="communication">COMM LINE</button>
    </div>
    
    <table class="sensor-table">
        <tbody>
            <tr>
                <td>Device ID</td>
                <td id="obu-tx-device-id">-</td>
            </tr>
            <tr>
                <td>Latitude</td>
                <td id="obu-tx-latitude">-</td>
            </tr>
            <tr>
                <td>Longitude</td>
                <td id="obu-tx-longitude">-</td>
            </tr>
            <tr>
                <td>Speed</td>
                <td id="obu-tx-speed">-</td>
            </tr>
            <tr>
                <td>Heading</td>
                <td id="obu-tx-heading">-</td>
            </tr>
            <tr>
                <td>SW Version</td>
                <td id="obu-tx-sw-version">-</td>
            </tr>
            <tr>
                <td>HW Version</td>
                <td id="obu-tx-hw-version">-</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- OBU RX 장치 센서값 -->
<div id="obu-rx-sensor" class="sensor-panel" style="display: none;">
    <div class="sensor-header">
        <h3>🚗 <span id="obu-rx-device-name">OBU RX Device</span></h3>
        <div class="device-status">
            <span id="obu-rx-status">연결됨</span>
            <span id="obu-rx-last-seen">방금 전</span>
        </div>
    </div>
    
    <!-- 장치별 제어 버튼 -->
    <div class="sensor-controls">
        <button id="obu-rx-auto-track" class="sensor-control-button">AUTO TRACK</button>
        <button id="obu-rx-visible-path" class="sensor-control-button">VISIBLE PATH</button>
        <button id="obu-rx-communication-line" class="sensor-control-button" data-button-type="communication">COMM LINE</button>
    </div>
    
    <table class="sensor-table">
        <tbody>
            <tr>
                <td>Device ID</td>
                <td id="obu-rx-device-id">-</td>
            </tr>
            <tr>
                <td>Latitude</td>
                <td id="obu-rx-latitude">-</td>
            </tr>
            <tr>
                <td>Longitude</td>
                <td id="obu-rx-longitude">-</td>
            </tr>
            <tr>
                <td>Speed</td>
                <td id="obu-rx-speed">-</td>
            </tr>
            <tr>
                <td>Heading</td>
                <td id="obu-rx-heading">-</td>
            </tr>
            <tr>
                <td>SW Version</td>
                <td id="obu-rx-sw-version">-</td>
            </tr>
            <tr>
                <td>HW Version</td>
                <td id="obu-rx-hw-version">-</td>
            </tr>
            <tr>
                <td>Distance</td>
                <td id="obu-rx-distance">-</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- RSU 장치 센서값 -->
<div id="rsu-sensor" class="sensor-panel" style="display: none;">
    <div class="sensor-header">
        <h3>📡 <span id="rsu-device-name">RSU Infrastructure</span></h3>
        <div class="device-status">
            <span id="rsu-status">활성</span>
            <span id="rsu-last-seen">상시 연결</span>
        </div>
    </div>
    
    <!-- RSU 제어 버튼 -->
    <div class="sensor-controls">
        <button id="rsu-communication-line" class="sensor-control-button" data-button-type="communication">COMM LINE</button>
    </div>
    <table class="sensor-table">
        <tbody>
            <tr>
                <td>Device ID</td>
                <td id="rsu-device-id">-</td>
            </tr>
            <tr>
                <td>Latitude</td>
                <td id="rsu-latitude">-</td>
            </tr>
            <tr>
                <td>Longitude</td>
                <td id="rsu-longitude">-</td>
            </tr>
            <tr>
                <td>Role</td>
                <td id="rsu-role">Infrastructure</td>
            </tr>
            <tr>
                <td>Coverage</td>
                <td id="rsu-coverage">500m</td>
            </tr>
        </tbody>
    </table>
</div>

<!-- 활성 장치 목록 표시 (OBU/RSU 분리) -->
<div id="device-list-container">
    <!-- OBU 섹션 -->
    <div class="device-section-expandable">
        <div class="device-list-header obu-header">
            <button class="device-list-header-button">
                <h3>🚗 OBU Devices</h3>
                <div id="obu-count" class="device-count">0개</div>
            </button>
        </div>
                    <div id="obu-list" class="device-list" style="display: none;">
                <div class="no-devices">검색된 OBU 장치가 없습니다</div>
            </div>
    </div>
    
    <!-- RSU 섹션 -->
    <div class="device-section-expandable">
        <div class="device-list-header rsu-header">
            <button class="device-list-header-button">
                <h3>📡 RSU Infrastructure</h3>
                <div id="rsu-count" class="device-count">0개</div>
            </button>
        </div>
                    <div id="rsu-list" class="device-list" style="display: none;">
                <div class="no-devices">검색된 RSU 장치가 없습니다</div>
            </div>
    </div>
</div>

<div id="modal-background"></div>

<div id="modal">
    <h2>KETI ATHENA<br>Application Software</h2>
    <label for="vehType">차량 Type C-VEH(cv), 또는 A-VEH(av)를 입력하세요.</label><br>
    <input type="text" id="vehType" class="modal-input" placeholder="cv 또는 av"><br>
    <label for="testType">입력 파일 Type(Tx 또는 Rx)를 입력하세요.</label><br>
    <input type="text" id="testType" class="modal-input" placeholder="Tx 또는 Rx"><br>
    <label for="ipAddress">장비 IP 주소를 입력하세요.</label><br>
    <input type="text" id="ipAddress" class="modal-input" placeholder="기본값: 10.252.110.58"><br>
    <label for="visiblePath">Visible Path 여부 (Yes 또는 No)를 입력하세요.</label><br>
    <input type="text" id="visiblePath" class="modal-input" placeholder="기본값: No"><br>
    <label for="regionSelect">지역을 선택하세요.</label><br>
    <select id="regionSelect" class="modal-input">
        <option value="pangyo">판교</option>
        <option value="daegu">대구</option>
        <option value="incheon">인천</option>
        <option value="cheongju">청주</option>
        <option value="hwaseong">화성</option>
    </select><br>
    <button id="submit-button" class="modal-button">확인</button>
</div>

<button id="autoTrackButton">AUTO TRACK</button>
<button id="visiblePathButton">VISIBLE PATH</button>

<div id="ci-logo">
    <img src="https://raw.githubusercontent.com/KETI-A/athena/main/src/apps/html/images/keti_ci.png" alt="CI Logo">
</div>
<div id="coordinate-popup" style="display: none; position: absolute; padding: 10px; background-color: rgba(0, 0, 0, 0.8); color: white; border-radius: 5px; font-size: 14px; z-index: 10;">
    <p id="coordinate-text"></p>
</div>





<div id="datetime-info"></div>

<script src="main.js"></script>

</body>
</html>